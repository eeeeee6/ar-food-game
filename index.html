<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AR å…­å¤§é¡é£Ÿç‰©éŠæˆ² V2</title>
    
    <!-- A-Frame å’Œ AR.js -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }

        /* èƒŒæ™¯é¡Œç›®åœ– */
        #background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 1;
            pointer-events: none;
        }

        .a-canvas {
            z-index: 2 !important;
        }

        /* åˆ†æ•¸é¡¯ç¤º */
        #score-display {
            position: fixed;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, rgba(0,0,0,0.85), rgba(30,30,30,0.95));
            color: #FFD700;
            padding: 12px 20px;
            border-radius: 12px;
            z-index: 100;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        /* é¡Œç›®æ¨™é¡Œ */
        #question-title {
            position: fixed;
            top: 15px;
            left: 15px;
            background: linear-gradient(135deg, rgba(0,0,0,0.85), rgba(30,30,30,0.95));
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            z-index: 100;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        /* è¿½è¹¤æŒ‡ç¤ºå™¨ */
        #tracking-status {
            position: fixed;
            top: 70px;
            left: 15px;
            background: rgba(0,0,0,0.7);
            padding: 8px 15px;
            border-radius: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #tracking-status .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #666;
            transition: all 0.3s;
        }

        #tracking-status .dot.active {
            background: #4CAF50;
            box-shadow: 0 0 10px #4CAF50;
        }

        #tracking-status .text {
            color: white;
            font-size: 13px;
        }

        /* åµæ¸¬é€²åº¦æ¢ */
        #detection-progress {
            position: fixed;
            bottom: 180px;
            left: 50%;
            transform: translateX(-50%);
            width: 220px;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 5px;
            overflow: hidden;
            z-index: 100;
            display: none;
        }

        #detection-progress .bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.05s linear;
            border-radius: 5px;
        }

        /* åº•éƒ¨ UI */
        #ui-overlay {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            text-align: center;
            background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(20,20,20,0.95));
            padding: 20px 35px;
            border-radius: 20px;
            display: none;
            box-shadow: 0 8px 30px rgba(0,0,0,0.5);
            min-width: 280px;
        }

        #food-title {
            color: white;
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        #food-category {
            color: #aaa;
            font-size: 14px;
            margin-bottom: 15px;
        }

        #confirm-button {
            padding: 14px 35px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
        }

        #confirm-button:active {
            transform: scale(0.95);
        }

        /* ä¸­å¤®é€šçŸ¥ */
        #notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px 50px;
            border-radius: 20px;
            z-index: 200;
            font-size: 22px;
            display: none;
            text-align: center;
            box-shadow: 0 10px 50px rgba(0,0,0,0.6);
        }

        /* è¼‰å…¥ç•«é¢ */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.2);
            border-top-color: #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #loading-text {
            color: white;
            font-size: 20px;
        }

        /* èªªæ˜å’Œé–‹å§‹æŒ‰éˆ• */
        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 500;
            padding: 20px;
        }

        #start-screen h1 {
            color: white;
            font-size: 32px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        #start-screen .instructions {
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 15px;
            color: white;
            max-width: 350px;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        #start-screen .instructions h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }

        #start-screen .instructions p {
            margin: 8px 0;
            font-size: 15px;
        }

        #start-button {
            padding: 18px 60px;
            font-size: 22px;
            background: white;
            color: #764ba2;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }

        #start-button:active {
            transform: scale(0.95);
        }

        /* çµæœç•«é¢ */
        #result-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #11998e, #38ef7d);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 500;
        }

        #result-screen h1 {
            color: white;
            font-size: 36px;
            margin-bottom: 20px;
        }

        #result-screen .score-box {
            background: rgba(255,255,255,0.2);
            padding: 40px 60px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
        }

        #result-screen .final-score {
            color: #FFD700;
            font-size: 72px;
            font-weight: bold;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        #result-screen .score-label {
            color: white;
            font-size: 20px;
            margin-top: 10px;
        }

        #result-screen .accuracy {
            color: rgba(255,255,255,0.9);
            font-size: 18px;
            margin-top: 15px;
        }

        #restart-button {
            padding: 18px 50px;
            font-size: 20px;
            background: white;
            color: #11998e;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<!-- é–‹å§‹ç•«é¢ -->
<div id="start-screen">
    <h1>ğŸ½ï¸ AR å…­å¤§é¡é£Ÿç‰©éŠæˆ²</h1>
    <div class="instructions">
        <h3>éŠæˆ²èªªæ˜</h3>
        <p>1ï¸âƒ£ ç•«é¢æœƒé¡¯ç¤ºç¼ºå°‘æŸé¡é£Ÿç‰©çš„é¤ç›¤</p>
        <p>2ï¸âƒ£ æ‰¾åˆ°å°æ‡‰çš„é£Ÿç‰©åœ–å¡ä¸¦æƒæ</p>
        <p>3ï¸âƒ£ å°æº–åœ–å¡ 2 ç§’æˆ–é»æ“Šç¢ºèª</p>
        <p>4ï¸âƒ£ å…± 5 é¡Œï¼Œæ¸¬è©¦ä½ çš„ç‡Ÿé¤ŠçŸ¥è­˜ï¼</p>
    </div>
    <button id="start-button">é–‹å§‹éŠæˆ²</button>
</div>

<!-- è¼‰å…¥ç•«é¢ -->
<div id="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <div id="loading-text">è¼‰å…¥ä¸­...</div>
</div>

<!-- çµæœç•«é¢ -->
<div id="result-screen">
    <h1>ğŸ‰ éŠæˆ²çµæŸï¼</h1>
    <div class="score-box">
        <div class="final-score" id="final-score">0</div>
        <div class="score-label">åˆ†</div>
        <div class="accuracy" id="accuracy">æ­£ç¢ºç‡: 0%</div>
    </div>
    <button id="restart-button">å†ç©ä¸€æ¬¡</button>
</div>

<!-- éŠæˆ² UI -->
<div id="background"></div>
<div id="score-display">åˆ†æ•¸: 0</div>
<div id="question-title">ç¬¬ 1 é¡Œ</div>

<div id="tracking-status">
    <div class="dot" id="tracking-dot"></div>
    <span class="text">ç­‰å¾…æƒæ...</span>
</div>

<div id="detection-progress">
    <div class="bar" id="detection-bar"></div>
</div>

<div id="notification"></div>

<!-- A-Frame AR å ´æ™¯ -->
<a-scene 
    embedded 
    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
    vr-mode-ui="enabled: false"
    renderer="logarithmicDepthBuffer: true; precision: medium;">
    
    <a-assets timeout="30000">
        <!-- ä½¿ç”¨å…§å»ºå¹¾ä½•åœ–å½¢ä»£æ›¿ GLBï¼ˆæ–¹ä¾¿æ¸¬è©¦ï¼‰ -->
    </a-assets>

    <!-- ä½¿ç”¨ ArUco/Barcode marker (æ›´ç©©å®š) -->
    <!-- Marker 0: è±†é­šè›‹è‚‰é¡ -->
    <a-marker type="barcode" value="0" id="marker1" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-box position="0 0.5 0" color="#FF6B6B" scale="0.5 0.5 0.5"
               animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-box>
        <a-text value="è›‹ç™½è³ª" position="0 1.2 0" align="center" color="#FF6B6B" scale="2 2 2"></a-text>
    </a-marker>
    
    <!-- Marker 1: è”¬èœé¡ -->
    <a-marker type="barcode" value="1" id="marker2" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-cone position="0 0.5 0" color="#4CAF50" radius-bottom="0.4" height="0.8"
                animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-cone>
        <a-text value="è”¬èœ" position="0 1.2 0" align="center" color="#4CAF50" scale="2 2 2"></a-text>
    </a-marker>
    
    <!-- Marker 2: å…¨ç©€é›œç³§é¡ -->
    <a-marker type="barcode" value="2" id="marker3" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-cylinder position="0 0.3 0" color="#FFB74D" radius="0.4" height="0.5"
                    animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-cylinder>
        <a-text value="å…¨ç©€" position="0 1.0 0" align="center" color="#FFB74D" scale="2 2 2"></a-text>
    </a-marker>
    
    <!-- Marker 3: æ°´æœé¡ -->
    <a-marker type="barcode" value="3" id="marker4" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-sphere position="0 0.5 0" color="#E040FB" radius="0.4"
                  animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-sphere>
        <a-text value="æ°´æœ" position="0 1.2 0" align="center" color="#E040FB" scale="2 2 2"></a-text>
    </a-marker>
    
    <!-- Marker 4: ä¹³å“é¡ -->
    <a-marker type="barcode" value="4" id="marker5" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-box position="0 0.4 0" color="#29B6F6" scale="0.3 0.7 0.3"
               animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-box>
        <a-text value="ä¹³å“" position="0 1.0 0" align="center" color="#29B6F6" scale="2 2 2"></a-text>
    </a-marker>
    
    <!-- Marker 5: æ²¹è„‚èˆ‡å …æœç¨®å­é¡ -->
    <a-marker type="barcode" value="5" id="marker6" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
        <a-dodecahedron position="0 0.5 0" color="#FDD835" radius="0.35"
                        animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true">
        </a-dodecahedron>
        <a-text value="å …æœ" position="0 1.2 0" align="center" color="#FDD835" scale="2 2 2"></a-text>
    </a-marker>

    <a-entity camera></a-entity>
</a-scene>

<div id="ui-overlay">
    <div id="food-title"></div>
    <div id="food-category"></div>
    <button id="confirm-button">ç¢ºèªé¸æ“‡</button>
</div>

<script>
// ============================================================
// ä½ç½®å¹³æ»‘å™¨ - è§£æ±º AR ç‰©é«”æŠ–å‹•å•é¡Œ
// ============================================================
class PositionSmoother {
    constructor(smoothFactor = 0.7) {
        this.smoothFactor = smoothFactor;
        this.lastPositions = new Map();
        this.lastSeen = new Map();
        this.timeout = 500;
    }

    smooth(id, newPos) {
        const now = Date.now();
        
        if (!this.lastPositions.has(id) || 
            now - this.lastSeen.get(id) > this.timeout) {
            this.lastPositions.set(id, {...newPos});
            this.lastSeen.set(id, now);
            return newPos;
        }

        const last = this.lastPositions.get(id);
        const smoothed = {
            x: last.x * this.smoothFactor + newPos.x * (1 - this.smoothFactor),
            y: last.y * this.smoothFactor + newPos.y * (1 - this.smoothFactor),
            z: last.z * this.smoothFactor + newPos.z * (1 - this.smoothFactor)
        };

        this.lastPositions.set(id, smoothed);
        this.lastSeen.set(id, now);
        return smoothed;
    }
}

// ============================================================
// é£Ÿç‰©è³‡æ–™
// ============================================================
const foodData = [
    {
        id: 'marker1',
        barcodeValue: 0,
        title: 'é›è›‹',
        category: 'è±†é­šè›‹è‚‰é¡',
        color: '#FF6B6B',
        questionImage: null // å¯æ›¿æ›ç‚ºå¯¦éš›åœ–ç‰‡ URL
    },
    {
        id: 'marker2',
        barcodeValue: 1,
        title: 'é«˜éº—èœ',
        category: 'è”¬èœé¡',
        color: '#4CAF50',
        questionImage: null
    },
    {
        id: 'marker3',
        barcodeValue: 2,
        title: 'ç™½é£¯',
        category: 'å…¨ç©€é›œç³§é¡',
        color: '#FFB74D',
        questionImage: null
    },
    {
        id: 'marker4',
        barcodeValue: 3,
        title: 'æŸ³ä¸',
        category: 'æ°´æœé¡',
        color: '#E040FB',
        questionImage: null
    },
    {
        id: 'marker5',
        barcodeValue: 4,
        title: 'ç‰›å¥¶',
        category: 'ä¹³å“é¡',
        color: '#29B6F6',
        questionImage: null
    },
    {
        id: 'marker6',
        barcodeValue: 5,
        title: 'èŠ±ç”Ÿ',
        category: 'æ²¹è„‚èˆ‡å …æœç¨®å­é¡',
        color: '#FDD835',
        questionImage: null
    }
];

// ============================================================
// éŠæˆ²ç‹€æ…‹
// ============================================================
let gameState = {
    isPlaying: false,
    currentQuestion: 0,
    totalQuestions: 5,
    score: 0,
    questions: [],
    currentAnswer: null,
    scannedMarker: null,
    isDetecting: false,
    detectionStartTime: null,
    autoConfirmDelay: 2000 // 2ç§’è‡ªå‹•ç¢ºèª
};

const smoother = new PositionSmoother(0.7);

// ============================================================
// DOM å…ƒç´ 
// ============================================================
const elements = {
    startScreen: document.getElementById('start-screen'),
    startButton: document.getElementById('start-button'),
    loadingOverlay: document.getElementById('loading-overlay'),
    resultScreen: document.getElementById('result-screen'),
    finalScore: document.getElementById('final-score'),
    accuracy: document.getElementById('accuracy'),
    restartButton: document.getElementById('restart-button'),
    background: document.getElementById('background'),
    scoreDisplay: document.getElementById('score-display'),
    questionTitle: document.getElementById('question-title'),
    trackingDot: document.getElementById('tracking-dot'),
    trackingStatus: document.getElementById('tracking-status'),
    detectionProgress: document.getElementById('detection-progress'),
    detectionBar: document.getElementById('detection-bar'),
    uiOverlay: document.getElementById('ui-overlay'),
    foodTitle: document.getElementById('food-title'),
    foodCategory: document.getElementById('food-category'),
    confirmButton: document.getElementById('confirm-button'),
    notification: document.getElementById('notification')
};

// ============================================================
// éŠæˆ²å‡½æ•¸
// ============================================================
function shuffleArray(array) {
    const arr = [...array];
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function initGame() {
    // éš¨æ©Ÿé¸ 5 é¡Œ
    gameState.questions = shuffleArray(foodData).slice(0, gameState.totalQuestions);
    gameState.currentQuestion = 0;
    gameState.score = 0;
    gameState.isPlaying = true;
    
    updateUI();
    showQuestion();
}

function showQuestion() {
    const question = gameState.questions[gameState.currentQuestion];
    gameState.currentAnswer = question.id;
    
    // æ›´æ–°èƒŒæ™¯ï¼ˆå¦‚æœæœ‰é¡Œç›®åœ–ç‰‡ï¼‰
    if (question.questionImage) {
        elements.background.style.backgroundImage = `url(${question.questionImage})`;
    } else {
        // é¡¯ç¤ºæ–‡å­—æç¤º
        elements.background.style.background = 'transparent';
    }
    
    elements.questionTitle.textContent = `ç¬¬ ${gameState.currentQuestion + 1} é¡Œ`;
    elements.questionTitle.innerHTML += `<br><small style="font-size:14px;">æ‰¾ã€Œ${question.category}ã€</small>`;
    
    resetDetection();
}

function updateUI() {
    elements.scoreDisplay.textContent = `åˆ†æ•¸: ${gameState.score}`;
}

function resetDetection() {
    gameState.isDetecting = false;
    gameState.detectionStartTime = null;
    gameState.scannedMarker = null;
    elements.detectionProgress.style.display = 'none';
    elements.detectionBar.style.width = '0%';
    elements.uiOverlay.style.display = 'none';
    elements.trackingDot.classList.remove('active');
    elements.trackingStatus.querySelector('.text').textContent = 'ç­‰å¾…æƒæ...';
}

function startDetection(markerId) {
    if (!gameState.isPlaying) return;
    if (gameState.isDetecting && gameState.scannedMarker === markerId) return;
    
    gameState.scannedMarker = markerId;
    gameState.isDetecting = true;
    gameState.detectionStartTime = Date.now();
    
    // æ›´æ–° UI
    elements.trackingDot.classList.add('active');
    elements.trackingStatus.querySelector('.text').textContent = 'åµæ¸¬ä¸­...';
    elements.detectionProgress.style.display = 'block';
    
    // é¡¯ç¤ºé£Ÿç‰©è³‡è¨Š
    const food = foodData.find(f => f.id === markerId);
    if (food) {
        elements.foodTitle.textContent = food.title;
        elements.foodCategory.textContent = food.category;
        elements.uiOverlay.style.display = 'block';
    }
    
    // é–‹å§‹é€²åº¦æ›´æ–°
    updateDetectionProgress();
}

function updateDetectionProgress() {
    if (!gameState.isDetecting) return;
    
    const elapsed = Date.now() - gameState.detectionStartTime;
    const progress = Math.min(elapsed / gameState.autoConfirmDelay * 100, 100);
    
    elements.detectionBar.style.width = `${progress}%`;
    
    if (progress >= 100) {
        confirmAnswer();
    } else {
        requestAnimationFrame(updateDetectionProgress);
    }
}

function stopDetection() {
    gameState.isDetecting = false;
    elements.trackingDot.classList.remove('active');
    elements.trackingStatus.querySelector('.text').textContent = 'è¿½è¹¤ä¸Ÿå¤±';
    
    // å»¶é²éš±è— UI
    setTimeout(() => {
        if (!gameState.isDetecting) {
            elements.detectionProgress.style.display = 'none';
            elements.detectionBar.style.width = '0%';
            elements.uiOverlay.style.display = 'none';
        }
    }, 300);
}

function confirmAnswer() {
    if (!gameState.scannedMarker || !gameState.isPlaying) return;
    
    const isCorrect = gameState.scannedMarker === gameState.currentAnswer;
    
    if (isCorrect) {
        gameState.score++;
        updateUI();
        showFeedback(true, 'ç­”å°äº†ï¼+1 åˆ†');
    } else {
        showFeedback(false, 'ç­”éŒ¯äº†ï¼');
    }
    
    // ä¸‹ä¸€é¡Œ
    setTimeout(() => {
        gameState.currentQuestion++;
        
        if (gameState.currentQuestion < gameState.totalQuestions) {
            showQuestion();
            showNotification('è«‹æ‰¾ä¸‹ä¸€å€‹é£Ÿç‰©ï¼');
        } else {
            endGame();
        }
    }, 1500);
}

function showFeedback(isCorrect, message) {
    Swal.fire({
        toast: true,
        position: 'center',
        icon: isCorrect ? 'success' : 'error',
        title: message,
        showConfirmButton: false,
        timer: 1200,
        background: isCorrect ? 'rgba(76, 175, 80, 0.95)' : 'rgba(244, 67, 54, 0.95)',
        color: 'white'
    });
}

function showNotification(message) {
    elements.notification.textContent = message;
    elements.notification.style.display = 'block';
    setTimeout(() => {
        elements.notification.style.display = 'none';
    }, 2000);
}

function endGame() {
    gameState.isPlaying = false;
    
    elements.finalScore.textContent = gameState.score;
    elements.accuracy.textContent = `æ­£ç¢ºç‡: ${Math.round(gameState.score / gameState.totalQuestions * 100)}%`;
    elements.resultScreen.style.display = 'flex';
}

// ============================================================
// äº‹ä»¶ç›£è½
// ============================================================

// é–‹å§‹æŒ‰éˆ•
elements.startButton.addEventListener('click', () => {
    elements.startScreen.style.display = 'none';
    initGame();
});

// é‡æ–°é–‹å§‹æŒ‰éˆ•
elements.restartButton.addEventListener('click', () => {
    elements.resultScreen.style.display = 'none';
    initGame();
});

// ç¢ºèªæŒ‰éˆ•
elements.confirmButton.addEventListener('click', () => {
    if (gameState.isDetecting) {
        confirmAnswer();
    }
});

// Marker äº‹ä»¶
document.querySelectorAll('a-marker').forEach(marker => {
    marker.addEventListener('markerFound', (event) => {
        console.log('Marker found:', event.target.id);
        startDetection(event.target.id);
    });
    
    marker.addEventListener('markerLost', (event) => {
        console.log('Marker lost:', event.target.id);
        if (gameState.scannedMarker === event.target.id) {
            stopDetection();
        }
    });
});

// é é¢è¼‰å…¥å®Œæˆ
window.addEventListener('load', () => {
    console.log('AR å…­å¤§é¡é£Ÿç‰©éŠæˆ² V2 å·²è¼‰å…¥');
});
</script>

</body>
</html>
